app.controller("Orders",["$scope","$sessionStorage","$http","$cookies","$sce",function(a,b,c,d,e){a.account=JSON.parse(d.get("User").substring(d.get("User").indexOf("{"),d.get("User").lastIndexOf("}")+1)),a.history="6M",a.currentPage=1,a.pageSize=5,a.begin=0,a.setOrderRange=function(){switch(a.D1,a.D2,a.history){case"6M":a.D1=moment().utc().subtract(6,"months").format("YYYY-MM-DD HH:mm:ss"),a.D2=moment().utc().format("YYYY-MM-DD HH:mm:ss");break;case"30D":a.D1=moment().utc().subtract(30,"days").format("YYYY-MM-DD HH:mm:ss"),a.D2=moment().utc().format("YYYY-MM-DD HH:mm:ss");break;default:a.D1=moment().year(a.history).month(0).date(1).format("YYYY-MM-DD"),a.D2=moment().year(a.history).month(11).date(31).format("YYYY-MM-DD")}c.get("/api/order/"+a.account.UserID+"?DateFrom="+a.D1+"&DateTo="+a.D2).success(function(b){a.orders=b,a.totalItems=Math.ceil(b.length/a.pageSize),c.get("/api/product").success(function(c){a.products=c,a.getProduct=function(b){var c=_.find(a.products,function(a){return b==a.ProductID?!0:void 0});return c};var d=new RegExp("1Z?[0-9A-Z]{3}?[0-9A-Z]{3}?[0-9A-Z]{2}?[0-9A-Z]{4}?[0-9A-Z]{3}?[0-9A-Z]|[dT]ddd?dddd?ddd"),e=new RegExp("^[0-9]{15}");for(var f in b)d.test(b[f].OrderShipCode)?b[f].OrderShipper="UPS":e.test(b[f].OrderShipCode)?b[f].OrderShipper="FedEx":b[f].OrderShipper="No Tracking Available"}).error(function(a){console.log(a)})}).error(function(a){console.log(a)})},a.setOrderRange(),a.popover={templateUrl:"address.html"},a.years=[2016,2015],a.goNext=function(b){a.currentPage=a.currentPage+b,a.begin=a.begin+a.pageSize*b},a.goPage=function(b){a.currentPage=b,a.begin=a.pageSize*(b-1)}}]);